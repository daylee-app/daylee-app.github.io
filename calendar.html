<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daylee Calendar</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: #f4f4f4;
      color: #1f2937;
    }
    .calendar {
      max-width: 900px;
      margin: auto;
      padding: 1rem;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .day {
      background: #fff;
      padding: 0.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 0 4px rgba(0,0,0,0.1);
      cursor: pointer;
      position: relative;
    }
    .day:hover {
      background: #e0f2fe;
    }
    .day .date {
      font-weight: bold;
    }
    .day .events {
      font-size: 0.85em;
      margin-top: 0.25rem;
      color: #2563eb;
    }
    .modal-bg, .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      justify-content: center;
      align-items: center;
    }
    .modal-bg {
      background: rgba(0,0,0,0.5);
    }
    .modal {
      background: #fff;
      padding: 1rem;
      border-radius: 0.5rem;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    .modal input, .modal textarea {
      width: 100%;
      margin: 0.25rem 0;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 0.25rem;
    }
    .modal button {
      margin-top: 0.5rem;
      padding: 0.5rem 1rem;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 0.25rem;
      cursor: pointer;
    }
    .hour-row {
      display: flex;
      align-items: center;
      padding: 0.25rem 0;
    }
    .hour-label {
      width: 4rem;
      font-weight: bold;
    }
    .hour-events {
      flex: 1;
      padding-left: 0.5rem;
    }
    .add-hour-event-btn {
      background: none;
      border: none;
      color: #2563eb;
      font-size: 1.25rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="calendar">
    <div class="header">
      <h1 id="monthYear"></h1>
      <button onclick="openAddModal()">+ Add Event</button>
    </div>
    <div class="days" id="days"></div>
  </div>

  <!-- Event Modal -->
  <div class="modal-bg" id="eventModalBg">
    <div class="modal">
      <h2>Add Event</h2>
      <input id="eventTitle" placeholder="Event Title" />
      <input id="eventDate" type="date" />
      <input id="eventTime" type="time" />
      <textarea id="eventDesc" placeholder="Description"></textarea>
      <button onclick="saveEvent()">Save</button>
    </div>
  </div>

  <!-- Day Detail Modal -->
  <div class="modal-bg" id="dayDetailModalBg">
    <div class="modal">
      <h2 id="dayDetailTitle"></h2>
      <div id="hourSchedule"></div>
      <button onclick="closeDayDetail()">Close</button>
    </div>
  </div>

  <script>
    const daysEl = document.getElementById('days');
    const monthYear = document.getElementById('monthYear');
    const eventModalBg = document.getElementById('eventModalBg');
    const dayDetailModalBg = document.getElementById('dayDetailModalBg');
    const hourSchedule = document.getElementById('hourSchedule');
    const dayDetailTitle = document.getElementById('dayDetailTitle');
    const eventTitle = document.getElementById('eventTitle');
    const eventDate = document.getElementById('eventDate');
    const eventTime = document.getElementById('eventTime');
    const eventDesc = document.getElementById('eventDesc');

    const today = new Date();
    const currentMonth = today.getMonth();
    const currentYear = today.getFullYear();
    const familyEvents = [];

    const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

    function renderCalendar(month, year) {
      daysEl.innerHTML = '';
      const firstDay = new Date(year, month, 1).getDay();
      const totalDays = new Date(year, month + 1, 0).getDate();
      monthYear.textContent = `${year} â€“ ${new Date(year, month).toLocaleString('default', { month: 'long' })}`;

      for (let i = 0; i < firstDay; i++) {
        daysEl.innerHTML += `<div></div>`;
      }

      for (let d = 1; d <= totalDays; d++) {
        const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
        const dayBox = document.createElement('div');
        dayBox.className = 'day';
        dayBox.onclick = () => openDayDetail(d, month, year);

        const dateLabel = document.createElement('div');
        dateLabel.className = 'date';
        dateLabel.textContent = d;

        const eventsDiv = document.createElement('div');
        eventsDiv.className = 'events';
        const dayEvents = familyEvents.filter(e => e.date === dateStr);
        eventsDiv.innerHTML = dayEvents.map(e =>
          (e.time ? `<b>${e.time}</b> ` : '') + e.title
        ).join('<br>');

        dayBox.appendChild(dateLabel);
        dayBox.appendChild(eventsDiv);
        daysEl.appendChild(dayBox);
      }
    }

    function openAddModal() {
      eventModalBg.style.display = 'flex';
      eventTitle.value = '';
      eventDate.value = '';
      eventTime.value = '';
      eventDesc.value = '';
    }

    function saveEvent() {
      const event = {
        title: eventTitle.value,
        date: eventDate.value,
        time: eventTime.value,
        desc: eventDesc.value
      };
      familyEvents.push(event);
      eventModalBg.style.display = 'none';
      renderCalendar(currentMonth, currentYear);
    }

    function openDayDetail(day, month, year) {
      const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
      dayDetailModalBg.style.display = 'flex';
      dayDetailTitle.textContent = `${daysOfWeek[new Date(year, month, day).getDay()]}, ${month + 1}/${day}/${year}`;
      renderHourSchedule(dateStr);
    }

    function renderHourSchedule(dateStr) {
      hourSchedule.innerHTML = '';
      for (let h = 0; h < 24; h++) {
        const hourLabel = h.toString().padStart(2, '0') + ':00';
        const hourRow = document.createElement('div');
        hourRow.className = 'hour-row';

        const label = document.createElement('div');
        label.className = 'hour-label';
        label.textContent = hourLabel;

        const eventsDiv = document.createElement('div');
        eventsDiv.className = 'hour-events';

        const hourEvents = familyEvents.filter(e => e.date === dateStr && e.time && e.time.startsWith(hourLabel.slice(0, 2)));
        if (hourEvents.length > 0) {
          eventsDiv.innerHTML = hourEvents.map(e =>
            `<b>${e.time}</b> ${e.title}<br><span style="color:#64748b;font-size:0.95em;">${e.desc || ''}</span>`
          ).join('<br>');
        }

        const addBtn = document.createElement('button');
        addBtn.className = 'add-hour-event-btn';
        addBtn.textContent = '+';
        addBtn.title = `Add event at ${hourLabel}`;
        addBtn.onclick = function() {
          dayDetailModalBg.style.display = 'none';
          eventModalBg.style.display = 'flex';
          eventTitle.value = '';
          eventDate.value = dateStr;
          eventTime.value = hourLabel.slice(0, 2) + ':00';
          eventDesc.value = '';
        };

        hourRow.appendChild(label);
        hourRow.appendChild(eventsDiv);
        hourRow.appendChild(addBtn);
        hourSchedule.appendChild(hourRow);
      }
    }

    function closeDayDetail() {
      dayDetailModalBg.style.display = 'none';
    }

    renderCalendar(currentMonth, currentYear);
  </script>
</body>
</html>
